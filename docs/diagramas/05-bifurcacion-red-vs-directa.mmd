flowchart TD
    START["ðŸ­ Coordinador Planta\nCrea Despacho"] --> DECIDE{"Â¿CÃ³mo asignar\ntransporte?"}
    
    DECIDE -->|"AsignaciÃ³n Directa"| DIRECTO
    DECIDE -->|"Red Nodexia\n(Marketplace)"| RED
    
    subgraph DIRECTO["FLUJO DIRECTO"]
        D1["Seleccionar transporte\nde lista de relaciones"] 
        D2["Transporte ve despacho\nen 'Despachos Ofrecidos'"]
        D3["Transporte asigna\nchofer + camiÃ³n + acoplado"]
    end
    
    subgraph RED["FLUJO RED NODEXIA"]
        R1["Publicar viaje\nen Red Nodexia"]
        R2["Transportes ven carga\nen 'Cargas en Red'"]
        R3["Transportes envÃ­an\nofertas"]
        R4["Coordinador revisa\ny acepta oferta"]
        R5["Transporte asigna\nchofer + camiÃ³n + acoplado"]
    end
    
    D1 --> D2 --> D3
    R1 --> R2 --> R3 --> R4 --> R5
    
    D3 --> MERGE["âœ… Estado: camion_asignado\nâ†“ Flujo unificado"]
    R5 --> MERGE
    
    MERGE --> CHOFER_CONF["Chofer confirma viaje"]
    CHOFER_CONF --> FLOW["â†’ Flujo de estados operativos"]

    style START fill:#3b82f6,color:#fff
    style DECIDE fill:#f59e0b,color:#000
    style MERGE fill:#22c55e,color:#fff
    style DIRECTO fill:#e0f2fe,stroke:#3b82f6
    style RED fill:#f3e8ff,stroke:#a855f7
